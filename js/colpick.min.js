/*!
 * colpick Color Picker
 * https://github.com/mrgrain/colpick
 *
 * Copyright 2013, 2015 Moritz Kornher, Jose Vargas, Stefan Petre
 * Released under the MIT license and GPLv2 license
 * https://github.com/mrgrain/colpick/blob/master/LICENSE
 */
!function(t){"function"==typeof define&&define.amd?define(["jquery"],t):"object"==typeof exports?t(require("jquery")):t(jQuery)}((function(t){var e,o,i,a,c,l,r,d,n,s,p,u,f,h,v,g,k,m,_,b,y,x,w,I,M,C,q,T,S=(e={showEvent:"click",onShow:function(){},onBeforeShow:function(){},onHide:function(){},onChange:function(){},onSubmit:function(){},colorScheme:"light",color:"auto",livePreview:!0,flat:!1,layout:"full",submit:1,submitText:"OK",height:156,polyfill:!1,styles:!1},o=function(e,o){var i=Y(e);t(o).data("colpick").fields.eq(1).val(i.r).end().eq(2).val(i.g).end().eq(3).val(i.b).end()},i=function(e,o){t(o).data("colpick").fields.eq(4).val(Math.round(e.h)).end().eq(5).val(Math.round(e.s)).end().eq(6).val(Math.round(e.b)).end()},a=function(e,o){t(o).data("colpick").fields.eq(0).val(N(e))},c=function(e,o){t(o).data("colpick").selector.css("backgroundColor","#"+N({h:e.h,s:100,b:100})),t(o).data("colpick").selectorIndic.css({left:parseInt(t(o).data("colpick").height*e.s/100,10),top:parseInt(t(o).data("colpick").height*(100-e.b)/100,10)})},l=function(e,o){t(o).data("colpick").hue.css("top",parseInt(t(o).data("colpick").height-t(o).data("colpick").height*e.h/360,10))},r=function(e,o){t(o).data("colpick").currentColor.css("backgroundColor","#"+N(e))},d=function(e,o){t(o).data("colpick").newColor.css("backgroundColor","#"+N(e))},n=function(){var e,r=t(this).parent().parent();this.parentNode.className.indexOf("_hex")>0?(r.data("colpick").color=e=E(q(this.value)),o(e,r.get(0)),i(e,r.get(0))):this.parentNode.className.indexOf("_hsb")>0?(r.data("colpick").color=e=M({h:parseInt(r.data("colpick").fields.eq(4).val(),10),s:parseInt(r.data("colpick").fields.eq(5).val(),10),b:parseInt(r.data("colpick").fields.eq(6).val(),10)}),o(e,r.get(0)),a(e,r.get(0))):(r.data("colpick").color=e=P(C({r:parseInt(r.data("colpick").fields.eq(1).val(),10),g:parseInt(r.data("colpick").fields.eq(2).val(),10),b:parseInt(r.data("colpick").fields.eq(3).val(),10)})),a(e,r.get(0)),i(e,r.get(0))),c(e,r.get(0)),l(e,r.get(0)),d(e,r.get(0)),r.data("colpick").onChange.apply(r.parent(),[e,N(e),Y(e),r.data("colpick").el,0])},s=function(){t(this).parent().removeClass("colpick_focus")},p=function(){t(this).parent().parent().data("colpick").fields.parent().removeClass("colpick_focus"),t(this).parent().addClass("colpick_focus")},u=function(e){e.preventDefault?e.preventDefault():e.returnValue=!1;var o=t(this).parent().find("input").focus(),i={el:t(this).parent().addClass("colpick_slider"),max:this.parentNode.className.indexOf("_hsb_h")>0?360:this.parentNode.className.indexOf("_hsb")>0?100:255,y:e.pageY,field:o,val:parseInt(o.val(),10),preview:t(this).parent().parent().data("colpick").livePreview};t(document).mouseup(i,h),t(document).mousemove(i,f)},f=function(t){return t.data.field.val(Math.max(0,Math.min(t.data.max,parseInt(t.data.val-t.pageY+t.data.y,10)))),t.data.preview&&n.apply(t.data.field.get(0),[!0]),!1},h=function(e){return n.apply(e.data.field.get(0),[!0]),e.data.el.removeClass("colpick_slider").find("input").focus(),t(document).off("mouseup",h),t(document).off("mousemove",f),!1},v=function(e){e.preventDefault?e.preventDefault():e.returnValue=!1;var o={cal:t(this).parent(),y:t(this).offset().top};t(document).on("mouseup touchend",o,k),t(document).on("mousemove touchmove",o,g);var i="touchstart"==e.type?e.originalEvent.changedTouches[0].pageY:e.pageY;return n.apply(o.cal.data("colpick").fields.eq(4).val(parseInt(360*(o.cal.data("colpick").height-(i-o.y))/o.cal.data("colpick").height,10)).get(0),[o.cal.data("colpick").livePreview]),!1},g=function(t){var e="touchmove"==t.type?t.originalEvent.changedTouches[0].pageY:t.pageY;return n.apply(t.data.cal.data("colpick").fields.eq(4).val(parseInt(360*(t.data.cal.data("colpick").height-Math.max(0,Math.min(t.data.cal.data("colpick").height,e-t.data.y)))/t.data.cal.data("colpick").height,10)).get(0),[t.data.preview]),!1},k=function(e){return o(e.data.cal.data("colpick").color,e.data.cal.get(0)),a(e.data.cal.data("colpick").color,e.data.cal.get(0)),t(document).off("mouseup touchend",k),t(document).off("mousemove touchmove",g),!1},m=function(e){e.preventDefault?e.preventDefault():e.returnValue=!1;var o,i,a={cal:t(this).parent(),pos:t(this).offset()};return a.preview=a.cal.data("colpick").livePreview,t(document).on("mouseup touchend",a,b),t(document).on("mousemove touchmove",a,_),"touchstart"==e.type?(o=e.originalEvent.changedTouches[0].pageX,i=e.originalEvent.changedTouches[0].pageY):(o=e.pageX,i=e.pageY),n.apply(a.cal.data("colpick").fields.eq(6).val(parseInt(100*(a.cal.data("colpick").height-(i-a.pos.top))/a.cal.data("colpick").height,10)).end().eq(5).val(parseInt(100*(o-a.pos.left)/a.cal.data("colpick").height,10)).get(0),[a.preview]),!1},_=function(t){var e,o;return"touchmove"==t.type?(e=t.originalEvent.changedTouches[0].pageX,o=t.originalEvent.changedTouches[0].pageY):(e=t.pageX,o=t.pageY),n.apply(t.data.cal.data("colpick").fields.eq(6).val(parseInt(100*(t.data.cal.data("colpick").height-Math.max(0,Math.min(t.data.cal.data("colpick").height,o-t.data.pos.top)))/t.data.cal.data("colpick").height,10)).end().eq(5).val(parseInt(100*Math.max(0,Math.min(t.data.cal.data("colpick").height,e-t.data.pos.left))/t.data.cal.data("colpick").height,10)).get(0),[t.data.preview]),!1},b=function(e){return o(e.data.cal.data("colpick").color,e.data.cal.get(0)),a(e.data.cal.data("colpick").color,e.data.cal.get(0)),t(document).off("mouseup touchend",b),t(document).off("mousemove touchmove",_),!1},y=function(){var e=t(this).parent(),o=e.data("colpick").color;e.data("colpick").origColor=o,r(o,e.get(0)),e.data("colpick").onSubmit(o,N(o),Y(o),e.data("colpick").el)},x=function(e){e&&e.stopPropagation();var o=t("#"+t(this).data("colpickId"));e&&!o.data("colpick").polyfill&&e.preventDefault(),o.data("colpick").onBeforeShow.apply(this,[o.get(0)]);var i=t(this).offset(),a=i.top+this.offsetHeight,c=i.left,l=I(),r=o.width();c+r>l.l+l.w&&(c-=r),o.css({left:c+"px",top:a+"px"}),0!=o.data("colpick").onShow.apply(this,[o.get(0)])&&o.show(),t("html").mousedown({cal:o},w),o.mousedown((function(t){t.stopPropagation()}))},w=function(e){var o=t("#"+t(this).data("colpickId"));e&&(o=e.data.cal),0!=o.data("colpick").onHide.apply(this,[o.get(0)])&&o.hide(),t("html").off("mousedown",w)},I=function(){var t="CSS1Compat"==document.compatMode;return{l:window.pageXOffset||(t?document.documentElement.scrollLeft:document.body.scrollLeft),w:window.innerWidth||(t?document.documentElement.clientWidth:document.body.clientWidth)}},M=function(t){return{h:Math.min(360,Math.max(0,t.h)),s:Math.min(100,Math.max(0,t.s)),b:Math.min(100,Math.max(0,t.b))}},C=function(t){return{r:Math.min(255,Math.max(0,t.r)),g:Math.min(255,Math.max(0,t.g)),b:Math.min(255,Math.max(0,t.b))}},q=function(t){var e=6-t.length;if(3==e){for(var o=[],i=0;i<e;i++)o.push(t[i]),o.push(t[i]);t=o.join("")}else if(e>0){for(var a=[],c=0;c<e;c++)a.push("0");a.push(t),t=a.join("")}return t},T=function(){var e=t(this).parent(),r=e.data("colpick").origColor;e.data("colpick").color=r,o(r,e.get(0)),a(r,e.get(0)),i(r,e.get(0)),c(r,e.get(0)),l(r,e.get(0)),d(r,e.get(0))},{init:function(f){if("auto"===(f=t.extend({},e,f||{})).color);else if("string"==typeof f.color)f.color=E(f.color);else if(null!=f.color.r&&null!=f.color.g&&null!=f.color.b)f.color=P(f.color);else{if(null==f.color.h||null==f.color.s||null==f.color.b)return this;f.color=M(f.color)}return this.each((function(){if(!t(this).data("colpickId")){var e=t.extend({},f);if("auto"===f.color&&(e.color=t(this).val()?E(t(this).val()):{h:0,s:0,b:0}),e.origColor=e.color,"function"==typeof f.polyfill&&(e.polyfill=f.polyfill(this)),e.polyfill&&t(this).is("input")&&"color"===this.type)return;var h="collorpicker_"+parseInt(1e3*Math.random());t(this).data("colpickId",h);var g=t('<div class="colpick"><div class="colpick_color"><div class="colpick_color_overlay1"><div class="colpick_color_overlay2"><div class="colpick_selector_outer"><div class="colpick_selector_inner"></div></div></div></div></div><div class="colpick_hue"><div class="colpick_hue_arrs"><div class="colpick_hue_larr"></div><div class="colpick_hue_rarr"></div></div></div><div class="colpick_new_color"></div><div class="colpick_current_color"></div><div class="colpick_hex_field"><div class="colpick_field_letter">#</div><input type="text" maxlength="6" size="6" /></div><div class="colpick_rgb_r colpick_field"><div class="colpick_field_letter">R</div><input type="text" maxlength="3" size="3" /><div class="colpick_field_arrs"><div class="colpick_field_uarr"></div><div class="colpick_field_darr"></div></div></div><div class="colpick_rgb_g colpick_field"><div class="colpick_field_letter">G</div><input type="text" maxlength="3" size="3" /><div class="colpick_field_arrs"><div class="colpick_field_uarr"></div><div class="colpick_field_darr"></div></div></div><div class="colpick_rgb_b colpick_field"><div class="colpick_field_letter">B</div><input type="text" maxlength="3" size="3" /><div class="colpick_field_arrs"><div class="colpick_field_uarr"></div><div class="colpick_field_darr"></div></div></div><div class="colpick_hsb_h colpick_field"><div class="colpick_field_letter">H</div><input type="text" maxlength="3" size="3" /><div class="colpick_field_arrs"><div class="colpick_field_uarr"></div><div class="colpick_field_darr"></div></div></div><div class="colpick_hsb_s colpick_field"><div class="colpick_field_letter">S</div><input type="text" maxlength="3" size="3" /><div class="colpick_field_arrs"><div class="colpick_field_uarr"></div><div class="colpick_field_darr"></div></div></div><div class="colpick_hsb_b colpick_field"><div class="colpick_field_letter">B</div><input type="text" maxlength="3" size="3" /><div class="colpick_field_arrs"><div class="colpick_field_uarr"></div><div class="colpick_field_darr"></div></div></div><div class="colpick_submit"></div></div>').attr("id",h);g.addClass("colpick_"+e.layout+(e.submit?"":" colpick_"+e.layout+"_ns")),"light"!=e.colorScheme&&g.addClass("colpick_"+e.colorScheme),g.find("div.colpick_submit").html(e.submitText).click(y),e.fields=g.find("input").change(n).blur(s).focus(p),g.find("div.colpick_field_arrs").mousedown(u).end().find("div.colpick_current_color").click(T),e.selector=g.find("div.colpick_color").on("mousedown touchstart",m),e.selectorIndic=e.selector.find("div.colpick_selector_outer"),e.el=this,e.hue=g.find("div.colpick_hue_arrs");var k=e.hue.parent(),_=navigator.userAgent.toLowerCase(),b="Microsoft Internet Explorer"===navigator.appName,w=b?parseFloat(_.match(/msie ([0-9]*[\.0-9]+)/)[1]):0,I=["#ff0000","#ff0080","#ff00ff","#8000ff","#0000ff","#0080ff","#00ffff","#00ff80","#00ff00","#80ff00","#ffff00","#ff8000","#ff0000"];if(b&&w<10){var M,C;for(M=0;M<=11;M++)C=t("<div></div>").attr("style","height:8.333333%; filter:progid:DXImageTransform.Microsoft.gradient(GradientType=0,startColorstr="+I[M]+", endColorstr="+I[M+1]+'); -ms-filter: "progid:DXImageTransform.Microsoft.gradient(GradientType=0,startColorstr='+I[M]+", endColorstr="+I[M+1]+')";'),k.append(C)}else{var q=I.join(",");k.attr("style","background:-webkit-linear-gradient(top,"+q+"); background: -o-linear-gradient(top,"+q+"); background: -ms-linear-gradient(top,"+q+"); background:-moz-linear-gradient(top,"+q+"); -webkit-linear-gradient(top,"+q+"); background:linear-gradient(to bottom,"+q+"); ")}g.find("div.colpick_hue").on("mousedown touchstart",v),e.newColor=g.find("div.colpick_new_color"),e.currentColor=g.find("div.colpick_current_color"),g.data("colpick",e),o(e.color,g.get(0)),i(e.color,g.get(0)),a(e.color,g.get(0)),l(e.color,g.get(0)),c(e.color,g.get(0)),r(e.color,g.get(0)),d(e.color,g.get(0)),e.flat?(g.appendTo(e.appendTo||this).show(),g.css(e.styles||{position:"relative",display:"block"})):(g.appendTo(e.appendTo||document.body),t(this).on(e.showEvent,x),g.css(e.styles||{position:"absolute"}))}}))},showPicker:function(){return this.each((function(){t(this).data("colpickId")&&x.apply(this)}))},hidePicker:function(){return this.each((function(){t(this).data("colpickId")&&w.apply(this)}))},setColor:function(e,n){if(n=void 0===n?1:n,"string"==typeof e)e=E(e);else if(null!=e.r&&null!=e.g&&null!=e.b)e=P(e);else{if(null==e.h||null==e.s||null==e.b)return this;e=M(e)}return this.each((function(){if(t(this).data("colpickId")){var s=t("#"+t(this).data("colpickId"));s.data("colpick").color=e,s.data("colpick").origColor=e,o(e,s.get(0)),i(e,s.get(0)),a(e,s.get(0)),l(e,s.get(0)),c(e,s.get(0)),d(e,s.get(0)),s.data("colpick").onChange.apply(s.parent(),[e,N(e),Y(e),s.data("colpick").el,1]),n&&r(e,s.get(0))}}))},destroy:function(){var e=t(this);t("#"+e.data("colpickId")).remove(),e.removeData("colpickId");var o=t(document);o.off("mouseup touchend",k),o.off("mousemove touchmove",g),o.off("mouseup touchend",b),o.off("mousemove touchmove",_),o.off("mouseup",h),o.off("mousemove",f),t("html").off("mousedown",w)}}),D=function(t){return{r:(t=parseInt(t.indexOf("#")>-1?t.substring(1):t,16))>>16,g:(65280&t)>>8,b:255&t}},E=function(t){return P(D(t))},P=function(t){var e={h:0,s:0,b:0},o=Math.min(t.r,t.g,t.b),i=Math.max(t.r,t.g,t.b),a=i-o;return e.b=i,e.s=0!=i?255*a/i:0,0!=e.s?t.r==i?e.h=(t.g-t.b)/a:t.g==i?e.h=2+(t.b-t.r)/a:e.h=4+(t.r-t.g)/a:e.h=-1,e.h*=60,e.h<0&&(e.h+=360),e.s*=100/255,e.b*=100/255,e},Y=function(t){var e={},o=t.h,i=255*t.s/100,a=255*t.b/100;if(0==i)e.r=e.g=e.b=a;else{var c=a,l=(255-i)*a/255,r=o%60*(c-l)/60;360==o&&(o=0),o<60?(e.r=c,e.b=l,e.g=l+r):o<120?(e.g=c,e.b=l,e.r=c-r):o<180?(e.g=c,e.r=l,e.b=l+r):o<240?(e.b=c,e.r=l,e.g=c-r):o<300?(e.b=c,e.g=l,e.r=l+r):o<360?(e.r=c,e.g=l,e.b=c-r):(e.r=0,e.g=0,e.b=0)}return{r:Math.round(e.r),g:Math.round(e.g),b:Math.round(e.b)}},H=function(e){var o=[e.r.toString(16),e.g.toString(16),e.b.toString(16)];return t.each(o,(function(t,e){1==e.length&&(o[t]="0"+e)})),o.join("")},N=function(t){return H(Y(t))};t.fn.extend({colpick:S.init,colpickHide:S.hidePicker,colpickShow:S.showPicker,colpickSetColor:S.setColor,colpickDestroy:S.destroy}),t.extend({colpick:{rgbToHex:H,rgbToHsb:P,hsbToHex:N,hsbToRgb:Y,hexToHsb:E,hexToRgb:D}})}));
